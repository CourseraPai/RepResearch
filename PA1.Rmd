---
title: "Reproducible Research - Peer Assignment 1"
output: html_document
---

```{r}
df <- read.csv("G:/8.Reproducable Research/activity.csv", header=TRUE)
withNA <- read.csv("G:/8.Reproducable Research/activity.csv", header=TRUE)
withoutNA<-df[complete.cases(df),]
agg<-aggregate(df$steps ~ df$date, data=df, FUN=sum)
names(agg)<-c("date","steps")
attach(agg)
hist(steps)
aggavg<-aggregate(df$steps ~ df$interval, data=df, FUN=mean)
names(aggavg)<-c("interval","steps")
plot(aggavg$interval, aggavg$steps, type="l", xlab= "interval", ylab= "avgsteps", col="green" , lwd=2)
aggavg[order(-aggavg$steps),]
library(plyr)
meanfunc <- function(x) replace(x, is.na(x), mean(x, na.rm = TRUE))
aggavg<-aggregate(df$steps ~ df$interval, data=df, FUN=mean)
filledNA<-(ddply(df, ~ interval, transform,  steps= meanfunc(steps)))
aggavg<-aggregate(withoutNA$steps ~ withoutNA$interval, data=df, FUN=mean)
filledNA[order(filledNA$interval),]
summary(withoutNA)
summary(filledNA)
aggavg<-aggregate(filledNA$steps ~ filledNA$interval, data=filledNA, FUN=mean)
names(aggavg)<-c("interval","steps")
plot(aggavg$interval, aggavg$steps, type="l", xlab= "interval", ylab= "avgsteps", col="green" , lwd=2)
summary(aggavg)
filledNA$Daytype<-ifelse(weekdays(as.Date(filledNA$date)) %in% c('Sunday','Saturday'), 'Weekend', 'Weekday')
library(lattice)
aggavg<-aggregate(filledNA$steps ~ filledNA$Daytype+filledNA$interval, data=filledNA, FUN=mean)
names(aggavg)<-c("Daytype","interval","steps")
xyplot(steps~interval|Daytype, group=Daytype, data=aggavg, type="l",layout=c(1,2))

```

